---
import * as content from '../../lib/content';

interface Props {
    id: string;
    href?: string;
    class?: string;
}

const { id, href, class: className } = Astro.props;
const def = content.def(Astro.currentLocale, id);
const resolvedHref = href ?? def?.wiki;

if (!resolvedHref) {
    throw new Error(`Missing def href for ${id}`);
}

const label = def?.name.abbr ?? def?.name.short ?? def?.name.full ?? id;
const classes = ['link', 'def-tooltip-trigger', className].filter(Boolean).join(' ');
const isExternal = resolvedHref.startsWith('http://') || resolvedHref.startsWith('https://');
---

<a
    href={resolvedHref}
    class={classes}
    data-def-id={id}
    {...isExternal ? { target: '_blank', rel: 'noopener noreferrer' } : {}}>
    <slot>{label}</slot>
</a>
