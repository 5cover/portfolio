---
import HomePage from '../../components/pages/HomePage.astro';

import {
    getContacts,
    getLangData,
    getLangs,
    getPianoTiles,
    getProjects,
} from '../../lib/content';

export async function getStaticPaths() {
    const langs = await getLangs();
    return langs.map(lang => ({ params: { lang } }));
}

const { lang } = Astro.params;
if (!lang) {
    throw new Error('Missing lang param');
}

const [langData, projects, contacts, pianoTiles] = await Promise.all([
    getLangData(lang),
    getProjects(lang),
    getContacts(),
    getPianoTiles(lang),
]);

---

<HomePage
    lang={lang}
    langData={langData}
    pianoTiles={pianoTiles}
    projects={projects}
    contacts={contacts}
    copy={{
        indexMe: langData.indexMe,
        indexAboutMeContent: langData.indexAboutMeContent,
        indexMyPhoto: langData.indexMyPhoto,
        indexOngoingProjects: langData.indexOngoingProjects,
        indexAllMyProjects: langData.indexAllMyProjects,
        indexContact: langData.indexContact,
        indexMyResumePreview: langData.indexMyResumePreview,
        indexMyResume: langData.indexMyResume,
        indexVideoCv: langData.indexVideoCv,
        ongoing: langData.ongoing,
        fmtTitle: langData.fmtTitle,
    }}
/>
