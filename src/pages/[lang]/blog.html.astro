---
import LiteratureIndexPage from '../../components/pages/LiteratureIndexPage.astro';
import { getLangData, getLangs, getLiterature } from '../../lib/content';

export async function getStaticPaths() {
  const langs = await getLangs();
  return langs.map((lang) => ({ params: { lang } }));
}

const { lang } = Astro.params;
if (!lang) {
  throw new Error('Missing lang param');
}

const [langData, literature] = await Promise.all([getLangData(lang), getLiterature(lang)]);
const blogs = literature.filter((entry) => entry.data.kind === 'blog');
---
<LiteratureIndexPage
  lang={lang}
  langData={langData}
  title={langData.namePagePerspectives}
  route="blog"
  langLabels={{ fmtTitle: langData.fmtTitle }}
  entries={blogs}
  mainClass="margined"
/>
